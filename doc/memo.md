覚書

# 概要
Parenを作成するにあたり検討した記録などを示す。

# 総称関数
初期のParenの関数は次の仕様で策定されていた。
- すべての関数は総称関数である
- 総称関数は実行時に第一引数の型から動的にディスパッチされる
- 引数のない総称関数は許さない
この策定の背景には次の背景がある。
- 型ごとのメソッドの乱立を避けたい
  =, string=, char=等
- packageをなくし、型で構造化したい
しかし、この仕様は次の理由で取りやめとなった。
- 引数無しの関数が使えないのため不便
- primitiveに総称関数をサポートすると実装が複雑になる

# クラス機構の実装
;; クラスは単なるハッシュマップ
(class Class (SuperClass ...)
    field ...)
<=> (<- Class  { :type :Car
                 :super '(:SuperClass ...)
                 :fields '(field ...) })

;; クラスの型を調べるにはtypeマクロを使用する。
(type Class) <=> ({} Class :type) => :Class

;; インスタンスの生成にはnewマクロを使用する。
(new :Car) <=> { type :car


;; メソッドはグローバルなそれにシグネチャをキーに持ち、値をメソッド本体に持つように実装
;; 名前衝突回避のためにメソッド名称にはドットを先頭につける。
(method .to_s ((Car car))
   body_forms)
<=> ({} $method.to_s signature body_form)

;; 必要に応じて初期化処理を
