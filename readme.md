# Parenとは
Paren（パレン）は少量の記述で処理が実現できるように設計されたプログラミング言語である。

また、単純な構文によりほとんど学習することなしに使用することができる。

## S式
ParenはS式を評価するプログラムである。

S式とは、アトムまたはリストのことをいう。

S式は評価されるとその結果として必ずS式を返す。

## アトム
アトムとは、S式を構成する最小単位のことをいう。

主要なアトムとして、次のものが存在する。

- 数値
- 文字列
- シンボル
- 関数
- マクロ
- スペシャルオペレーター

シンボルを除き、すべてのアトムは評価されると自身を返す。

    ) 1
    1
    ) "hello world"
    "hello world"

シンボルは、任意のS式への参照を保持することができるアトムであり、評価されると保持しているS式を返す。

## リスト
リストとは括弧で囲まれた任意の数のアトムのことをいう。以下はいずれもリストである。

- ()
- (1 2 3)
- (foo)

ここで、括弧内のそれぞれのS式のことをリストの要素という。

要素がないリストは空のリストと呼ばれシンボルnilと等価として扱われる。

リストは次の規則で評価される。

1. リストの先頭要素を評価
1. 先頭要素の規則に従い評価結果を返す

期待される先頭要素は次の通り。

- スペシャルオペレーター
- 関数
- マクロ

上記以外の場合はエラーとなる。

### スペシャルオペレーター
評価するリストの先頭要素がスペシャルオペレーターだった場合、各スペシャルオペレーターの規則に従い評価を行う。

ifは条件分岐をするためのスペシャルオペレーターである。先頭から順に、2n番目の要素を評価しnil以外の値が返された場合は2n + 1番目の要素を評価した結果を返して後の評価は行わない。ただし、2n番目の要素がリストの末尾か、2n + 2番目の要素が存在しない場合には最後に評価した結果を返す。

    ) (if (= 0 0) 0)
    0
    ) (if (= 0 1) 0)
    nil
    ) (if (= 0 0) 0 1)
    0
    ) (if (= 0 1) 0 1)
    1
    ) (if (= 0 2) 0
          (= 1 2) 1
          (= 2 2) 2
          (= 3 2) 3)
    2

`->`オペレーターは2n番目のシンボルに2n + 1番目の評価結果を対応付けるオペレーターである。

    ) (-> sym1 1
          sym2 (+ 2 3))
    5
    ) sym1
    1
    ) sym2
    5

スペシャルオペレーターはユーザが定義することはできない。

すべてのスペシャルオペレーターの説明は言語仕様を参照のこと。

### 関数
評価するリストの先頭要素が関数だった場合は、リストの二番目以降の要素を順に評価し、それらを関数の引数として関数本体を評価する。

いくつかの組み込み関数の使用例を示す。S式の評価が再帰的に行われていることを確認されたい。

    ) (+ 1 2 3)
    6
    ) (/ (* 100 (+ 100 1)) 2)
    5050

関数は後述する`function`マクロを使用してユーザが自由に定義できる。

### マクロの例
評価するリストの先頭要素がマクロだった場合は、マクロの定義に従って新たなS式に展開された後、評価される。

マクロはユーザが自由に追加できるが、チュートリアルで扱う範疇を超えているためここでは組み込みマクロの`function`の使用例を挙げるだけに留める。

`function`は関数を作成し、指定したシンボルに対応づける。

    ) (function add3 (x) (+ x 3))
    add3
    ) (function add5 (x) (+ x 5))
    add5
    ) (add3 8)
    11
    ) (add5 (add3 8))
    16

### 簡単な例
すでに述べた機能を利用して簡単なプログラムの例を示す。

    ) (function fib (x)
        (if (< x 2) 1
            (+ (fib (- x 1)) (fib (- x 2)))))
    fib
    ) (fib 5)
    5
    ) (map (.. 1 5) fib)
    (1 1 2 3 5 8)

# ビルド
Parenのビルド例を示す。

    $ git clone https://github.com/mukaiizawa/Paren your/favorite/dir
    $ cd your/favorite/dir
    $ make os=windows
    $ paren
    ) (print "hello world")
    "hello world"

コマンドライン引数なしで実行すると、インタープリタが起動する。コマンドライン引数がある場合、第一引数をスクリプトファイルとして読み込み、引数無しのmain関数が存在すればそれを実行する。

    $ cat scrypt.p
    (function main ()
      (print "hello world"))
    $ paren scrypt.p
    "hello world"

# チュートリアル
tutorial.mdを参照のこと。

# Special Thanks
Ken'ichi Tokuoka.
