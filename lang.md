Paren言語仕様書

この資料はParenの仕様を定義する。

# 基本概念
ParenはCommon Lispと様々なオブジェクト指向言語から影響を受けた言語である。
Common Lispをよりオブジェクト指向に扱えるように工夫がされてある。
## S式
Parenはatomまたはlistにより記述される。
この記述をS式と呼ぶ。
S式は評価されると値を返す。

# メタ言語
Parenの文法を以下のEBNF表記で定義する。
    x? -- xは省略可能。
    x | y -- x又はy。
    x+ -- xの一回以上の繰り返し。
    x* -- xの零回以上の繰り返し。
    () -- グループ化。
    'x' -- 固定字句。文字の並びxを示す。xは複数の場合もある。
    [...] -- 文字グループ。[]内で指定された文字の何れか。
             x-yと表記された場合はxとyの間の何れかを表す。。
             先頭に~を指定した場合は[]内で指定された文字以外の何れかを示す。
    = -- 定義。左辺で示される構文要素は右辺で定義される。

# 字句規則
字句規則はリードマクロ展開時とParen評価時の２つ存在する。
ここではParenの評価時の字句規則を示す。
ユーザが定義するリードマクロの展開結果は、
この字句規則から外れてはならない。
## 字句の区切り(separator)
    separator = space | comment
Parenは空白又はコメントにより区切られる。
これらは要素の区切りとして使用される以外は無視される。
### コメント(comment)
    comment = (';'.*$ | '#|'.*'|#')
コメントはセミコロンから行末まで、
または、#|で始まり|#で終わる任意の文字列で表現される。
### 空白(space)
    space = [\t\n ]
空白はタブ文字、改行文字、半角スペースである。
## S式(s_expr)
    s_expr = list | atom
S式はリストまたはアトムである。
### リスト(list)
    list = '(' s_expr (separator s_expr)* ')'
リストは1以上のS式を括弧で括ったものである。
### アトム(atom)
    atom = symbol
      | keyword
      | number
      | char
      | string
アトムは次のうちのいずれかである。
- シンボル
- キーワード
- 数値
- 文字
- 文字列
#### シンボル(symbol)
    symbol = xletter+
シンボルは'(', ')'以外から始まる任意の文字の列である。
なお、Common Lispで許可されているシンボル
vertical barに挟まれた任意の文字の列
    '|' .* '|'
全体の集合のうち、
上記の定義から外れるものはシンボルとは見做さない。
#### キーワード(keyword)
    keyword = ':' xletter+
キーワードは':'から始まる任意の文字の列である。
##### 予約外文字(xletter)
    xletter = [^():`',\]
予約外文字はParenで特殊な意味を持ちうるもの以外の文字である。
#### 数値(number)
    number = integer | float
数値は整数または浮動小数点数である。
##### 整数(integer)
    integer = (0 | (+|-)?[1-9][0-9]*)
整数は0または、正の整数または負の整数である。
##### 浮動小数点数(float)
    float = integer '.' [0-9]*
浮動小数点数は整数の後に
#### 文字(char)
    char = ['] (. | '\'[tnr]) [']
文字はシングルクォートで囲まれた任意の一文字、
またはエスケープシーケンスである。
#### 文字列(string)
    string = '"' char* '"'
文字列はダブルクォートで囲まれた任意の文字の列である。
##### エスケープシーケンス(esc)
    esc = '\' .
エスケープシーケンスは'\'から始まり、次の意味をもつ。
- n: 改行
- t: 水平タブ
それ以外の文字は、文字そのものを表す。
